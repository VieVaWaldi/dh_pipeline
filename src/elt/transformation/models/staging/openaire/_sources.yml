version: 1
sources:
  - name: openaire
    description: "Raw OpenAIRE research data"
    schema: openaire
    tables:
      - name: project
        description: "Research project entries"
        columns:
          - name: id
            tests:
              - not_null
              - unique
          - name: id_original
            tests:
              - not_null
              - unique
          - name: id_openaire
            tests:
              - not_null
              - unique
          - name: code
            tests:
              - not_null
          - name: title
            tests:
              - not_null
          - name: doi
          - name: acronym
          - name: start_date
          - name: end_date
          - name: duration
          - name: summary
          - name: keywords
          - name: ec_article29_3
          - name: open_access_mandate_publications
          - name: open_access_mandate_dataset
          - name: ecsc39
          - name: total_cost
          - name: funded_amount
          - name: website_url
          - name: call_identifier
          - name: created_at
          - name: updated_at

      - name: researchoutput
        description: "Research output entries"
        columns:
          - name: id
            tests:
              - not_null
              - unique
          - name: id_original
            tests:
              - not_null
              - unique
          - name: main_title
            tests:
              - not_null
          - name: sub_title
          - name: publication_date
          - name: publisher
          - name: type
          - name: language_code
          - name: language_label
          - name: open_access_color
          - name: publicly_funded
          - name: is_green
          - name: is_in_diamond_journal
          - name: description
          - name: citation_count
          - name: influence
          - name: popularity
          - name: impulse
          - name: citation_class
          - name: influence_class
          - name: impulse_class
          - name: popularity_class
          - name: container_id
          - name: created_at
          - name: updated_at

      - name: author
        description: "Author information"
        columns:
          - name: id
            tests:
              - not_null
              - unique
          - name: full_name
            tests:
              - not_null
              - unique
          - name: first_name
          - name: surname
          - name: pid
          - name: created_at
          - name: updated_at

      - name: organization
        description: "Organization/institution information"
        columns:
          - name: id
            tests:
              - not_null
              - unique
          - name: original_id
          - name: legal_name
            tests:
              - not_null
              - unique
          - name: legal_short_name
          - name: is_first_listed
          - name: geolocation
          - name: alternative_names
          - name: website_url
          - name: country_code
          - name: country_label
          - name: created_at
          - name: updated_at

      - name: container
        description: "Publication container information (journals, conferences)"
        columns:
          - name: id
            tests:
              - not_null
              - unique
          - name: name
            tests:
              - not_null
              - unique
          - name: issn_printed
          - name: issn_online
          - name: issn_linking
          - name: volume
          - name: issue
          - name: start_page
          - name: end_page
          - name: edition
          - name: conference_place
          - name: conference_date
          - name: created_at
          - name: updated_at

      - name: subject
        description: "Subject/topic classification"
        columns:
          - name: id
            tests:
              - not_null
              - unique
          - name: value
            tests:
              - not_null
              - unique
          - name: scheme
          - name: provenance_type
          - name: trust
          - name: created_at
          - name: updated_at

      - name: measure
        description: "Measurement and metrics"
        columns:
          - name: id
            tests:
              - not_null
              - unique
          - name: name
            tests:
              - not_null
          - name: score
            tests:
              - not_null
          - name: created_at
          - name: updated_at

      - name: funder
        description: "Funding organizations"
        columns:
          - name: id
            tests:
              - not_null
              - unique
          - name: original_id
            tests:
              - not_null
              - unique
          - name: name
            tests:
              - not_null
              - unique
          - name: short_name
            tests:
              - not_null
          - name: jurisdiction
            tests:
              - not_null
          - name: created_at
          - name: updated_at

      - name: funding_stream
        description: "Funding streams and hierarchies"
        columns:
          - name: id
            tests:
              - not_null
              - unique
          - name: original_id
            tests:
              - not_null
              - unique
          - name: name
            tests:
              - not_null
          - name: description
          - name: parent_id
          - name: created_at
          - name: updated_at

      - name: h2020_programme
        description: "H2020 specific programmes"
        columns:
          - name: id
            tests:
              - not_null
              - unique
          - name: code
            tests:
              - not_null
              - unique
          - name: description
          - name: created_at
          - name: updated_at

      # Junction Tables
      - name: j_project_researchoutput
        description: "Junction table: projects to research outputs"
        columns:
          - name: project_id
          - name: researchoutput_id
          - name: relation_type

      - name: j_project_organization
        description: "Junction table: projects to organizations"
        columns:
          - name: project_id
          - name: organization_id
          - name: relation_type
          - name: validation_date
          - name: validated

      - name: j_project_subject
        description: "Junction table: projects to subjects"
        columns:
          - name: project_id
          - name: subject_id

      - name: j_project_measure
        description: "Junction table: projects to measures"
        columns:
          - name: project_id
          - name: measure_id

      - name: j_project_funder
        description: "Junction table: projects to funders"
        columns:
          - name: project_id
          - name: funder_id
          - name: currency
          - name: funded_amount
          - name: total_cost

      - name: j_project_funding_stream
        description: "Junction table: projects to funding streams"
        columns:
          - name: project_id
          - name: funding_stream_id

      - name: j_project_h2020_programme
        description: "Junction table: projects to H2020 programmes"
        columns:
          - name: project_id
          - name: h2020_programme_id

      - name: j_researchoutput_author
        description: "Junction table: research outputs to authors"
        columns:
          - name: research_output_id
          - name: author_id
          - name: rank

      - name: j_researchoutput_organization
        description: "Junction table: research outputs to organizations"
        columns:
          - name: research_output_id
          - name: organization_id
          - name: relation_type
          - name: country_code
          - name: country_label